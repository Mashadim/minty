var data = {
  "entry": "test.js",
  "log": [{
    "file": "test.js",
    "line": 2,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1
    }
  }, {
    "file": "test.js",
    "line": 3,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined"
    }
  }, {
    "file": "test.js",
    "line": 4,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      }
    }
  }, {
    "file": "test.js",
    "line": 5,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4]
    }
  }, {
    "file": "test.js",
    "line": 9,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "i": 0
    }
  }, {
    "file": "test.js",
    "line": 9,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "i": 1
    }
  }, {
    "file": "test.js",
    "line": 9,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "i": 2
    }
  }, {
    "file": "test.js",
    "line": 9,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "i": 3
    }
  }, {
    "file": "test.js",
    "line": 9,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "i": 4
    }
  }, {
    "file": "test.js",
    "line": 9,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "i": 5
    }
  }, {
    "file": "test.js",
    "line": 9,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "i": 6
    }
  }, {
    "file": "test.js",
    "line": 9,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "i": 7
    }
  }, {
    "file": "test.js",
    "line": 9,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "i": 8
    }
  }, {
    "file": "test.js",
    "line": 9,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "i": 9
    }
  }, {
    "file": "test.js",
    "line": 13,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "j": 0
    }
  }, {
    "file": "test.js",
    "line": 13,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "j": 1
    }
  }, {
    "file": "test.js",
    "line": 13,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "j": 2
    }
  }, {
    "file": "test.js",
    "line": 13,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "j": 3
    }
  }, {
    "file": "test.js",
    "line": 13,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "j": 4
    }
  }, {
    "file": "test.js",
    "line": 16,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "a": 1,
      "b": 2,
      "c": 3
    }
  }, {
    "file": "test.js",
    "line": 17,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "a": 1,
      "b": 2,
      "c": 3
    }
  }, {
    "file": "test.js",
    "line": 18,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "a": 1,
      "b": 2,
      "c": 3,
      "d": 4,
      "e": 5,
      "f": 6
    }
  }, {
    "file": "test.js",
    "line": 19,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "a": 1,
      "b": 2,
      "c": 3,
      "d": 4,
      "e": 5,
      "f": 6
    }
  }, {
    "file": "test.js",
    "line": 20,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "a": 1,
      "b": 2,
      "c": 3,
      "d": 4,
      "e": 5,
      "f": 6,
      "bus": "slow"
    }
  }, {
    "file": "test.js",
    "line": 22,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "a": 1,
      "b": 2,
      "c": 3
    }
  }, {
    "file": "test.js",
    "line": 23,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "a": 1,
      "b": 2,
      "c": 3,
      "car": "toyota"
    }
  }, {
    "file": "test.js",
    "line": 27,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4]
    }
  }, {
    "file": "test.js",
    "line": 30,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "val": 1
    }
  }, {
    "file": "test.js",
    "line": 31,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "val": 1
    }
  }, {
    "file": "test.js",
    "line": 30,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "val": 2
    }
  }, {
    "file": "test.js",
    "line": 31,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "val": 2
    }
  }, {
    "file": "test.js",
    "line": 30,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "val": 3
    }
  }, {
    "file": "test.js",
    "line": 31,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "val": 3
    }
  }, {
    "file": "test.js",
    "line": 34,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "val": 1,
      "i": 0
    }
  }, {
    "file": "test.js",
    "line": 35,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "val": 1,
      "i": 0
    }
  }, {
    "file": "test.js",
    "line": 34,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "val": 2,
      "i": 1
    }
  }, {
    "file": "test.js",
    "line": 35,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "val": 2,
      "i": 1
    }
  }, {
    "file": "test.js",
    "line": 34,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "val": 3,
      "i": 2
    }
  }, {
    "file": "test.js",
    "line": 35,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "val": 3,
      "i": 2
    }
  }, {
    "file": "test.js",
    "line": 43,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 10
    }
  }, {
    "file": "test.js",
    "line": 45,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 10
    }
  }, {
    "file": "test.js",
    "line": 46,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 10
    }
  }, {
    "file": "test.js",
    "line": 47,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 9
    }
  }, {
    "file": "test.js",
    "line": 45,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 9
    }
  }, {
    "file": "test.js",
    "line": 46,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 9
    }
  }, {
    "file": "test.js",
    "line": 47,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 8
    }
  }, {
    "file": "test.js",
    "line": 45,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 8
    }
  }, {
    "file": "test.js",
    "line": 46,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 8
    }
  }, {
    "file": "test.js",
    "line": 47,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 7
    }
  }, {
    "file": "test.js",
    "line": 45,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 7
    }
  }, {
    "file": "test.js",
    "line": 46,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 7
    }
  }, {
    "file": "test.js",
    "line": 47,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 6
    }
  }, {
    "file": "test.js",
    "line": 45,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 6
    }
  }, {
    "file": "test.js",
    "line": 46,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 6
    }
  }, {
    "file": "test.js",
    "line": 47,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 5
    }
  }, {
    "file": "test.js",
    "line": 45,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 5
    }
  }, {
    "file": "test.js",
    "line": 46,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 5
    }
  }, {
    "file": "test.js",
    "line": 47,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 4
    }
  }, {
    "file": "test.js",
    "line": 45,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 4
    }
  }, {
    "file": "test.js",
    "line": 46,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 4
    }
  }, {
    "file": "test.js",
    "line": 47,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 3
    }
  }, {
    "file": "test.js",
    "line": 56,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 3,
      "what": "what"
    }
  }, {
    "file": "test.js",
    "line": 58,
    "variables": {
      "one": "undefined",
      "two": 2,
      "three": 1,
      "four": 2,
      "five": "undefined",
      "seven": {
        "a": 1,
        "b": 2
      },
      "six": [1, 2, 3, 4],
      "checkThis": "function () {\n  console.log('hello there my friend');\n}",
      "k": 3,
      "what": "what"
    },
    "error": "that is not defined"
  }],
  "test.js": "\"use strict\";\n\nvar one, two = 2, three = 1;\nvar four = 2, five;\nvar seven = {a: 1, b: 2}\nvar six = [1,2,3,4];\n\n //what should we do if var test = 'shoot'\n\nfor(let i = 0; i < 10; i++) {\n\n}\n\nfor(var j = 0; j < 5; j++) {\n}\n\nfunction fn(a, b, c) {\n  console.log(a,b,c);\n  function fn2(d,e,f) {\n    console.log('what!');\n    var bus = 'slow';\n  }\n  fn2(4,5,6);\n  var car = 'toyota';\n}\n\n\nfn(1,2,3);\n\n\n[1,2,3].forEach(val => {\n  console.log(val);\n});\n\n[1,2,3].forEach((val, i) => {\n  console.log(val);\n});\n\nvar checkThis = function() {\n  console.log('hello there my friend');\n};\n\n\nvar k = 10;\n\nwhile(k !== 3) {\n  console.log(k);\n  k--\n}\n\n\n\n/*\n* here is another comment\n* with some stuff\n* shoot */\nlet what = 'what';\n\nconsole.log(that)\nvar test = \"hello\";\nvar wade = `wade`;\ntest += \" buddy\";\n\nconst hello = 'hi';\n"
}

$(document).ready(() => {

  var indexCounter = -1,
      dataLength = data.log.length,
      watchedVariables,
      completeVariableList = {},
      declaredVariables,
      oldIndex,
      newIndex;

  data.log.forEach((elem) => {
    for (var variables in elem.variables) {
      completeVariableList[variables] = undefined;
    }
  });
  // appending variable names to the DOM - all their values start out as undefined
  for (var key in completeVariableList) {
    $('tbody').append(`<tr id=${key}></tr>`);
    $(`#${key}`).append(`<td>${key}</td>`).append(`<td id=${key +'val'} class="variables">undefined</td>`);
  }
  declaredVariables = Object.keys(completeVariableList)


  disableBackFirstButtons(true);
  $('#step').text(`Step 0 of ${dataLength}`);
//
  $('#forward').click((e) => {

    if (indexCounter < dataLength - 1) {
      oldIndex = indexCounter;
      indexCounter++;
      newIndex = indexCounter;
      moveLineIndicator(newIndex, oldIndex, data.log);

      disableBackFirstButtons(false);
      $('#step').text(`Step ${indexCounter+1} of ${dataLength}`);

    }


    if (indexCounter === dataLength - 1)
      disableForwardLastButtons(true);

    //updating the variable values
    watchedVariables = data.log[indexCounter].variables;
    if (data.log[indexCounter]) {
      // console.log('indexCounter', indexCounter, 'variables:', data[indexCounter]);
      for (var key in watchedVariables) {
        updateVariables(key, watchedVariables);
      }
    }
    console.log("forward decvar", declaredVariables)
    // if user is analyzing a line of code and some of the variables are no longer on the watch list, those variables will get the value undefined
    varsNoLongerOnWatchList(declaredVariables, watchedVariables, indexCounter);
  });

  $('#back').click(() => {

    var watchedVariables,
        decVar;

    if (indexCounter > -1) {
      oldIndex = indexCounter;
      indexCounter--;
      newIndex = indexCounter;
      moveLineIndicator(newIndex, oldIndex, data.log);
      disableForwardLastButtons(false);
      $('#step').text(`Step ${indexCounter + 1} of ${dataLength}`);
    }
    //make all values revert back to undefined when the user clicks back all the way to the beginning with the back button
    if (indexCounter === -1) {
      makeValuesUndefined();
      return;
    }

    //when user clicks back, this will update the DOM with new values
    watchedVariables = data.log[indexCounter].variables;
    if (data.log[indexCounter]) {
      // console.log('indexCounter', indexCounter, 'old line:', data[oldIndex].line, 'new line:', data[newIndex].line, 'variables:', watchedVariables);
      for (var key in watchedVariables) {
        updateVariables(key, watchedVariables);
      }
    }

    // if user is analyzing a line of code and some of the variables are no longer on the watch list, those variables will get the value undefined
    varsNoLongerOnWatchList(declaredVariables, watchedVariables, indexCounter);
  });

//make all values revert back to undefined when the user clicks first
  $('#first').click(() => {
    if (indexCounter === dataLength - 1)
      disableForwardLastButtons(false);

    oldIndex = indexCounter;
    indexCounter = -1;
    newIndex = indexCounter;
    moveLineIndicator(newIndex, oldIndex, data.log);
    makeValuesUndefined();
    $('#step').text(`Step ${indexCounter + 1} of ${dataLength}`);
  });

  //display variables and their values from the last index of the data set
  $('#last').click(() => {
    var variable;
    if (indexCounter === -1)
      disableBackFirstButtons(false);

    oldIndex = indexCounter;
    indexCounter = dataLength - 1;
    newIndex = indexCounter;
    moveLineIndicator(newIndex, oldIndex, data.log);
    $('.variables').each((i, elem) => {
      variable = completeVariableList[declaredVariables[i]];
      $(elem).text(`${variable}`);
    });
    disableForwardLastButtons(true);
    $('#step').text(`Step ${indexCounter + 1} of ${dataLength}`);
  });

});

//updates variables when user clicks forward or back button
//updates variables when user clicks forward or back button
function updateVariables(variable, watchedVariables) {
  $(`#${variable + 'val'}`).remove();
  if (watchedVariables[variable] instanceof Array) {
    //i think i want to remove the children
    var handledArray = handleArrays(watchedVariables[variable], 0);
    displayArray(handledArray, variable);
  } else
    $(`#${variable}`).append(`<td id="${variable + 'val'}" class="variables">${watchedVariables[variable]}</td>`);
};

function handleArrays(array, depth) {
  var flattenedArray = [];
  var flattenedObj = {};
  var howNested = []
  function inner(array, depth) {
    var arr = [];
    array.forEach((elem) => {
      if (elem instanceof Array) arr.push("array");
      else arr.push(elem)
    })
    flattenedArray.push(depth, arr);
    if (!flattenedObj[depth]) flattenedObj[depth] = [];
    flattenedObj[depth].push(arr);

    howNested.push(depth);
    // i want to continue if the element is a number, string or variable, pretty anything not an array or object
    for (var i = 0, n = array.length; i < n; i ++) {
      if (typeof array[i] === 'number') continue;
      if (array[i] instanceof Array) {
        depth ++;
        inner(array[i], depth);
      }
      depth --;
    }
  }
  inner(array, depth);
  return flattenedObj;
}

function displayArray(nestedArrays, variable) {
  console.log(nestedArrays);

  $(`.array-table-${variable}`).remove();
  // $(`#${variable}`).append(`<td id="${variable + 'val'}" class="variables"></td>`);
  //
  $('body').append($('<table/>', {'id': `main-array-table`}));
  $('#main-array-table').append(
    $('<table/>', {'id': `array-table-${variable}`}).append(
      $('<tbody/>'), {'id': `array-body${variable}`}
    )
  );

  //    .append(
  //       $('<tr/>', {'id' : `array-display-row${counter}`})
  //     )
  // console.log('obji', nestedArrays);
  //
  // var numberOfLevels = Object.keys(nestedArrays).length;
  // for (var i = 0; i < numberOfLevels; i ++) {
  //   arraysAtDepthX = nestedArrays[i];
  //   arraysAtDepthX.forEach(array => {
  //     console.log(array);
  //     array.forEach(elem => {
  //       if (elem !== "array") {
  //
  //       }
  //     });
  //   });
  // }

  var numberOfLevels = Object.keys(nestedArrays);
  numberOfLevels.forEach((index) => {
    nestedArrays[index].forEach((array) => {
      array.forEach(elem => {
        console.log(elem);
      });
    });
  });

}


function disableForwardLastButtons(value) {
  $('#forward').prop('disabled', value);
  $('#last').prop('disabled', value);
};

function disableBackFirstButtons(value) {
  $('#back').prop('disabled', value);
  $('#first').prop('disabled', value);
};

function makeValuesUndefined() {
  $('.variables').each((i, elem) => {
    if ($(elem).text() !== 'undefined')
      $(elem).text('undefined');
  });
  disableBackFirstButtons(true)
};

function varsNoLongerOnWatchList(declaredVariables, watchedVariables, index) {
  console.log('not on watch list', declaredVariables)

  for (var i = 0, n = declaredVariables.length; i < n; i ++) {
    declaredVar = declaredVariables[i]
    console.log('BACK BACK BACK?', declaredVar);
    if (watchedVariables[declaredVar] === 0) return;
    if (!watchedVariables[declaredVar]) {
      console.log('BACK BACK inside if', declaredVar)
      $(`#${declaredVar + 'val'}`).remove();
      $(`#${declaredVar}`).append(`<td id="${declaredVar + 'val'}" class="variables">undefined</td>`);
    }
  }
}
